[
  {
    "path": "posts/2021-10-19-maximum-likelihood-estimation-of-mortality-models/",
    "title": "Maximum likelihood estimation of mortality models with Newton-Raphson algorithm",
    "description": "Estimation of the Gompertz and Log-quadratic models of mortality with maximum likelihood by applying Newton-Raphson maximization algorithm",
    "author": [
      {
        "name": "Benjamin Schlüter",
        "url": {}
      }
    ],
    "date": "2021-10-19",
    "categories": [],
    "contents": "\r\nThis blog post shows how to estimate parameters of a mortality model by maximum likelihood instead of using regression. The aim is to show the influence of outliers at the highest age on the parameters.Regression cannot estimates mx=0 while this is not a problem for likelihoo estimation. Optim() does not work and no real control of what is happening.\r\n\r\n\r\n\r\nWe’ll study old age mortality, higher or equal than 80 years old.\r\n\r\n\r\n\r\n\r\n\r\n\r\nNewton-Raphson’s maximization algorithm.\r\n\r\n\r\n# Design matrix\r\nX = matrix(c(rep(1, dim(df)[1]), df$Age),\r\n           ncol = 2)\r\n# vector of deaths and exposure\r\nD = df$D\r\nN = df$N\r\n# Expected deaths according to\r\n# alpha\r\nDhat = function(alpha) {\r\n  lambda.hat = X %*% alpha\r\n  return( as.numeric( N * exp(lambda.hat)))\r\n}\r\n# NR algorithm\r\nnext_alpha = function(alpha) {\r\n  dhat = Dhat(alpha)\r\n  M = solve ( t(X) %*% diag(dhat) %*% X)\r\n  v = t(X) %*% (D - dhat)\r\n  return( alpha + M %*% v)\r\n}\r\n\r\na = matrix(0, 2, 15)\r\nfor (i in 2:ncol(a)) { a[,i] = next_alpha(a[,i-1])}\r\n\r\n\r\n\r\nAlpha values over N-R iterations. Convergence before tenth iteration.\r\n\r\n\r\n\r\nGompertz fit of old age mortality. Regression gives more weights to rates at oldest ages.\r\n\r\n\r\n\r\n\r\n\r\n\r\nAlgorithm only need a third column in design matrix and an additional line in a. Alpha values over N-R iterations. Convergence before tenth iteration.\r\n\r\n\r\n\r\nGompertz and Log-Quadratic fits. Regression outputs more sensitive to outlying value.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-10-19-maximum-likelihood-estimation-of-mortality-models/maximum-likelihood-estimation-of-mortality-models_files/figure-html5/tidy data-1.png",
    "last_modified": "2021-10-22T14:28:09+02:00",
    "input_file": "maximum-likelihood-estimation-of-mortality-models.knit.md"
  },
  {
    "path": "posts/2021-10-04-welcome/",
    "title": "Introduction to Bayesian Temporal Smoothing",
    "description": "A short introduction to Temporal Smoothing of a proportion with Bayesian statistics. Code in R and STAN presented in the post.",
    "author": [
      {
        "name": "Benjamin Schlüter",
        "url": {}
      }
    ],
    "date": "2021-10-08",
    "categories": [],
    "contents": "\r\nSee slides 13, 30-32 from part 2 Wakefield to defines the topics of this post.\r\nSample prevalence in a area (small- medium size: impact on variation of proportion)\r\nBAYESIAN formula good for smoothing (prior)\r\n\r\n\r\n\r\n\r\n\r\n\r\nProportion of individuals with a characteristic over time.\r\n\r\n\r\n\r\nEstimating RW(1) model\r\n\r\n\r\n\r\n\r\n# STAN code\r\ndata {\r\n  int<lower=0> N; // number of lines\r\n  int<lower=0> T_pts; // number of time points\r\n  \r\n  int<lower=0, upper=1> y[N]; // success/failure\r\n  int<lower=1, upper=81> t[N]; // time point of success/failure\r\n}\r\nparameters {\r\n  real alpha;\r\n  vector[T_pts] phi;\r\n  real<lower=0> sigma;\r\n}\r\ntransformed parameters {\r\n  vector[T_pts] eta;\r\n  vector[T_pts] p_hat;\r\n\r\n  eta = alpha + phi;\r\n  \r\n  for (i in 1:T_pts){\r\n      p_hat[i] = 1/(1+exp(-eta[i]));\r\n  }\r\n}\r\nmodel {\r\n  \r\n  alpha ~ normal(0, 10);\r\n  phi[1] ~ normal(0, 10);\r\n  phi[2:T_pts] ~ normal(phi[1:(T_pts-1)], sigma);\r\n  sigma ~ normal(0, 10);\r\n  \r\n  for (i in 1:N) {\r\n      y[i] ~ bernoulli_logit(eta[ t[i] ]);\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-10-04-welcome/temp_smooth_p_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2021-10-12T21:50:55+02:00",
    "input_file": {}
  },
  {
    "path": "posts/welcome/",
    "title": "Demography of Belgium",
    "description": "Demographic indicators on Belgium's population with cool data visualizations",
    "author": [
      {
        "name": "Benjamin Schlüter",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2021-10-08",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-10-08T18:35:26+02:00",
    "input_file": {}
  }
]
